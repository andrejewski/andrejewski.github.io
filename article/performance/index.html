<!doctype html>
<html lang="en-US">
  <head>
    <title>Performance</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta
      name="description"
      content="Reasons for being adverse to optimization."
    />
    <meta name="robots" content="index, follow" />

    <link
      rel="canonical"
      href="https://jew.ski/article/performance/index.html"
    />

    <link rel="icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/logo192.png" />

    <meta name="theme-color" content="#178bfb" />

    <meta property="og:title" content="Performance" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="Chris Andrejewski" />
    <meta property="og:url" content="/article/performance/index.html" />

    <meta property="twitter:card" content="summary" />
    <meta name="twitter:site" content="compooter" />
    <meta name="twitter:title" content="Performance" />
    <meta
      name="twitter:description"
      content="Reasons for being adverse to optimization."
    />

    <link rel="stylesheet" href="/stylesheet/highlight-atom-one.css" />
    <style data-styled="true" data-styled-version="6.1.17">
      .bctNTf {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bctNTf {
          color: #5eb6ff;
        }
      } /*!sc*/
      data-styled.g1[id='sc-Qotzb'] {
        content: 'bctNTf,';
      } /*!sc*/
      .hxbvAH {
        padding-bottom: 4rem;
      } /*!sc*/
      data-styled.g2[id='sc-fYsHOw'] {
        content: 'hxbvAH,';
      } /*!sc*/
      .debzsy {
        background-color: #fff;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .debzsy {
          background-color: #16202e;
        }
      } /*!sc*/
      data-styled.g3[id='sc-dKREkF'] {
        content: 'debzsy,';
      } /*!sc*/
      .dtgyPg {
        padding: 0px 1rem;
        max-width: 720px;
        margin: 0px auto;
      } /*!sc*/
      data-styled.g4[id='sc-fWnslK'] {
        content: 'dtgyPg,';
      } /*!sc*/
      .eyyqef {
        margin: 15px 0em;
      } /*!sc*/
      .eyyqef:first-child {
        margin-top: 0px;
      } /*!sc*/
      .eyyqef:last-child {
        margin-bottom: 0px;
      } /*!sc*/
      data-styled.g5[id='sc-dIMoHT'] {
        content: 'eyyqef,';
      } /*!sc*/
      .hkwuxz {
        padding-top: 3rem;
        margin-bottom: 3rem;
      } /*!sc*/
      data-styled.g6[id='sc-iQQCXo'] {
        content: 'hkwuxz,';
      } /*!sc*/
      .foDfFI {
        font-size: 3rem;
        margin: 0px;
      } /*!sc*/
      @media (max-width: 720px) {
        .foDfFI {
          font-size: 1.8rem;
        }
      } /*!sc*/
      data-styled.g7[id='sc-gDpztx'] {
        content: 'foDfFI,';
      } /*!sc*/
      .iwpgrf {
        margin: 0;
        line-height: 1.5rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .iwpgrf {
          color: #dbe0e7;
        }
      } /*!sc*/
      data-styled.g8[id='sc-kpOvIu'] {
        content: 'iwpgrf,';
      } /*!sc*/
      .leFObR {
        display: inline-block;
        font-size: 0.9rem;
        line-height: 1rem;
        background-color: #dcefff;
        color: #151515;
        border-radius: 3px;
        padding: 0.25rem 0.5rem;
        margin: 0.25rem 0.5rem 0.25rem 0;
        text-decoration: none;
        white-space: nowrap;
      } /*!sc*/
      .leFObR:hover {
        text-decoration: underline;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .leFObR {
          background-color: #2f3d4e;
          color: #c8d2e0;
        }
      } /*!sc*/
      data-styled.g9[id='sc-icnseD'] {
        content: 'leFObR,';
      } /*!sc*/
      .iLjxYJ {
        color: inherit;
        text-decoration: none;
      } /*!sc*/
      .iLjxYJ:hover span {
        text-decoration: underline;
      } /*!sc*/
      .iLjxYJ:hover:after {
        opacity: 1;
      } /*!sc*/
      .iLjxYJ:after {
        content: 'ðŸ”—';
        padding: 0 0.5rem;
        font-size: 1rem;
        opacity: 0.25;
      } /*!sc*/
      data-styled.g10[id='sc-jMsorb'] {
        content: 'iLjxYJ,';
      } /*!sc*/
      * {
        box-sizing: border-box;
      } /*!sc*/
      body {
        margin: 0px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica,
          Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
          'Segoe UI Symbol';
        background-color: #eff7fd;
        color: #000;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #0d1117;
          color: #fff;
        }
      } /*!sc*/
      data-styled.g12[id='sc-global-kFwHxP1'] {
        content: 'sc-global-kFwHxP1,';
      } /*!sc*/
      .jjMGJZ {
        display: flex;
        justify-content: space-between;
        align-items: center;
      } /*!sc*/
      .jjMGJZ h1 {
        font-size: 1.5rem;
        padding: 1rem 0px;
        margin: 0;
      } /*!sc*/
      .jjMGJZ h1 a {
        text-decoration: none;
        color: inherit;
      } /*!sc*/
      .jjMGJZ h1 a:hover {
        text-decoration: underline;
      } /*!sc*/
      @media (max-width: 720px) {
        .jjMGJZ .sc-jJAtPt {
          display: none;
        }
      } /*!sc*/
      data-styled.g14[id='sc-cUiCeM'] {
        content: 'jjMGJZ,';
      } /*!sc*/
      .eEeLHI {
        border-top: 2px solid #d7d7d7;
        margin: 4rem 0;
        padding-top: 4rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .eEeLHI {
          border-color: #4c545e;
        }
      } /*!sc*/
      data-styled.g43[id='sc-kiMgGE'] {
        content: 'eEeLHI,';
      } /*!sc*/
      .bBqidV h1 > a,
      .bBqidV h2 > a,
      .bBqidV h3 > a,
      .bBqidV h4 > a,
      .bBqidV h5 > a,
      .bBqidV h6 > a {
        color: inherit;
        text-decoration: none;
      } /*!sc*/
      .bBqidV h1 > a:hover,
      .bBqidV h2 > a:hover,
      .bBqidV h3 > a:hover,
      .bBqidV h4 > a:hover,
      .bBqidV h5 > a:hover,
      .bBqidV h6 > a:hover {
        text-decoration: underline;
      } /*!sc*/
      .bBqidV p,
      .bBqidV li {
        line-height: 1.5rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV p,
        .bBqidV li {
          color: #dbe0e7;
        }
      } /*!sc*/
      .bBqidV a {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV a {
          color: #5eb6ff;
        }
      } /*!sc*/
      .bBqidV ul {
        padding-left: 1rem;
      } /*!sc*/
      .bBqidV code {
        font-family: Monaco, monospace;
      } /*!sc*/
      .bBqidV h1 code,
      .bBqidV h2 code,
      .bBqidV h3 code,
      .bBqidV h4 code,
      .bBqidV h5 code,
      .bBqidV h6 code,
      .bBqidV li code,
      .bBqidV p code {
        font-size: 0.9em;
        padding: 0 0.25em;
        border-radius: 3px;
        background-color: #eff7fd;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV h1 code,
        .bBqidV h2 code,
        .bBqidV h3 code,
        .bBqidV h4 code,
        .bBqidV h5 code,
        .bBqidV h6 code,
        .bBqidV li code,
        .bBqidV p code {
          background-color: #2b3644;
        }
      } /*!sc*/
      .bBqidV pre {
        background-color: #eff7fd;
        padding: 0.5rem 0.75rem;
        overflow-x: scroll;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV pre {
          background-color: #2b3645;
        }
      } /*!sc*/
      .bBqidV img {
        display: block;
        max-width: 100%;
        max-height: 520px;
        font-size: 0;
        margin: 0px auto;
        padding: 0px;
      } /*!sc*/
      .bBqidV video {
        display: block;
        margin: 1rem auto;
      } /*!sc*/
      .bBqidV figure {
        text-align: center;
        margin: 20px 0px;
      } /*!sc*/
      .bBqidV figure img {
        display: block;
        max-width: 90vw;
        margin: 0px auto;
      } /*!sc*/
      .bBqidV figure figcaption {
        opacity: 0.9;
        font-size: 1.1em;
        margin: 10px auto;
      } /*!sc*/
      .bBqidV .cali-collage {
        padding: 20px 0px;
        text-align: center;
      } /*!sc*/
      .bBqidV .cali-collage img {
        display: inline-block;
        margin: 10px;
        max-width: 95vw;
        vertical-align: middle;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
      } /*!sc*/
      data-styled.g44[id='sc-dCVDEO'] {
        content: 'bBqidV,';
      } /*!sc*/
      .hwSrQD {
        text-align: center;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .hwSrQD {
          color: #dbe0e7;
        }
      } /*!sc*/
      .hwSrQD h3 {
        margin: 0.5em 0;
      } /*!sc*/
      .hwSrQD p {
        margin: 0;
      } /*!sc*/
      data-styled.g45[id='sc-fhPBcz'] {
        content: 'hwSrQD,';
      } /*!sc*/
    </style>

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-G3SKTPFTEZ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag('js', new Date())
      gtag('config', 'G-G3SKTPFTEZ')
    </script>
  </head>
  <body>
    <div class="sc-dKREkF debzsy">
      <div class="sc-fYsHOw hxbvAH">
        <div class="sc-dKREkF debzsy">
          <div class="sc-fWnslK dtgyPg">
            <nav class="sc-cUiCeM jjMGJZ">
              <h1><a href="/">Chris Andrejewski</a></h1>
            </nav>
          </div>
        </div>
        <div class="sc-fWnslK dtgyPg">
          <div class="sc-iQQCXo hkwuxz">
            <p class="sc-kpOvIu iwpgrf">
              <a href="/writing" class="sc-icnseD leFObR">Articles</a
              ><a
                href="/category/engineering/index.html"
                class="sc-icnseD leFObR"
                >Engineering</a
              >
            </p>
            <h1 class="sc-gDpztx foDfFI">
              <a href="#" class="sc-jMsorb iLjxYJ"><span>Performance</span></a>
            </h1>
            <p class="sc-kpOvIu iwpgrf">
              Reasons for being adverse to optimization.
            </p>
          </div>
          <div class="sc-dIMoHT eyyqef">
            <div class="sc-dCVDEO bBqidV">
              <p>Performance optimization has the following problems:</p>
              <ul>
                <li>
                  <p>
                    Loss of code readability. The most heavily optimized version
                    of a solution does not take advantage of code reuse,
                    functions are not dynamically allocated, constants are
                    preallocated outside of the running function, and iteration
                    is done using low-level looping constructs and mutable
                    variables. All of which make the code verbose, more
                    error-prone, more spread out, and the original problem
                    harder to grasp.
                  </p>
                </li>
                <li>
                  <p>
                    Loss of code reusability. The greatest gains in optimization
                    come from the assumptions you are able to make about your
                    input and the assumptions and use of your output. This means
                    that to maximize an optimization you have to fully
                    understand the constraints of your problem. In other words,
                    when the problem changes your optimization will most likely
                    need reworking or to be completely overhauled. Meanwhile,
                    you have solved a specific problem but a very similar
                    problem with even slightly different assumptions cannot
                    borrow your efforts.
                  </p>
                </li>
                <li>
                  <p>
                    Loss of time. Optimization is hard and takes a lot of
                    thinking and research into the problem and its constraints.
                    And this is only the initial cost. Code that is more verbose
                    and complex, taking into account many potentially obscure
                    assumptions, is a tough read and even harder to update.
                  </p>
                </li>
              </ul>
              <p>
                When I write code, the things I value are business value,
                testability, readability, and correctness, in that order.
                Performance as a concern is dead last. Before I dip into
                performance optimization of any code, it must meet the following
                criteria:
              </p>
              <ul>
                <li>
                  <p>
                    The perceived business value is worth spending the time and
                    effort to optimize. If you are keen to weight the value
                    against the long term maintenance cost of that optimized
                    code as well as the initial cost: good job. Most
                    optimizations never pass this test.
                  </p>
                </li>
                <li>
                  <p>
                    There is a well-defined performance problem. Just as
                    business value is perceived, so is performance. Taking the
                    time to define what performance means in a tangible way is
                    essential to solving the problem. Should we be refactoring
                    to perform fewer object comparisons or refactor to show a
                    loading indicator or perhaps stream results so the user
                    perceives progress or feedback sooner. What tradeoffs can we
                    make: should time complexity be optimized over space
                    complexity on limited devices, and how active is our
                    underlying data as that dictates our caching mechanisms.
                    Ideally the goals reduce down to numbers you can look at and
                    aim for so you know at the end the problem is solved.
                  </p>
                </li>
                <li>
                  <p>
                    The existing solution must be well defined and correct. This
                    means that all of the assumptions we can make about the
                    inputs and outputs are articulated and preferably codified
                    as test cases. The test harness should come before the
                    re-implementation because code reuse, readability, and time
                    are better respected by a non-optimized solution. This usage
                    contract is a snapshot of the functionality the optimized
                    version must uphold. This is important because when
                    optimizing for performance we never want to impede
                    correctness as it is much more important. With incredible
                    luck, these tests may already exist. If they do not, factor
                    this task into the cost of the optimization.
                  </p>
                </li>
              </ul>
              <p>
                With the above criteria met, I will happily optimize. The great
                things about taking this stance are:
              </p>
              <ul>
                <li>
                  <p>
                    The criteria are almost never met. Looking the cost of an
                    optimization in the face, most businesses can do without
                    having something work 100 milliseconds faster.
                  </p>
                </li>
                <li>
                  <p>
                    Fulfilled criteria are a roadmap to a very good solution.
                    The research has been done: the constraints, tradeoffs, and
                    goals are known. The roadmap also has the maintenance
                    benefit of being an artifact, if written down, for future
                    maintainers to look at and understand why choices were made
                    the way they were, cushioning the blow to the problems
                    optimization cause.
                  </p>
                </li>
                <li>
                  <p>
                    The criteria take time to fulfill. Every day there is a new
                    problem to solve. Fulfilling these criteria means in itself
                    that due diligence went into the decision to optimize. The
                    decision was not made on a whim, which means resources are
                    more intelligently allocated to serious problems.
                  </p>
                </li>
              </ul>
              <p>
                In summation, optimization has costs of time, reusability, and
                readability. Before embarking to optimize I always want to know
                the optimization has business value, what my constraints are to
                solve the problem, and when I can know I have solved the
                problem. When I know all of that, the problem is easier to
                solve, the problem must be worth solving, and that gathered
                information has reduced maintenance costs for the optimized
                solution. Or better yet, we find the non-optimized solution is
                already good enough.
              </p>
            </div>
          </div>
          <div class="sc-dIMoHT eyyqef">
            <p class="sc-kpOvIu iwpgrf">
              <small
                ><time
                  datetime="2017-08-21T00:00:00.000Z"
                  title="2017-08-21T00:00:00.000Z"
                  >Published 8/21/2017</time
                ></small
              >
            </p>
          </div>
          <div
            class="sc-kiMgGE eEeLHI newsletter-container"
            data-frame-src="https://newsletter.jew.ski/frame/subscribe"
          >
            <div class="sc-fhPBcz hwSrQD">
              <h3>Subscribe for new articles</h3>
              <div class="newsletter-form"></div>
              <p>
                <small
                  >Or add the
                  <a href="/writing/feed.atom.xml" class="sc-Qotzb bctNTf"
                    >Atom feed</a
                  >
                  to your feed reader.</small
                >
              </p>
            </div>
            <script src="https://newsletter-js.jew.ski/v1/subscribe-embed.js"></script>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>

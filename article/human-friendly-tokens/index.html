<!doctype html>
<html lang="en-US">
  <head>
    <title>Human friendly tokens</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta
      name="description"
      content="Thoughts on designing tokens for secrets, sessions, and tokens."
    />
    <meta name="robots" content="index, follow" />

    <link
      rel="canonical"
      href="https://jew.ski/article/human-friendly-tokens/index.html"
    />

    <link rel="icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/logo192.png" />

    <meta name="theme-color" content="#178bfb" />

    <meta property="og:title" content="Human friendly tokens" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="Chris Andrejewski" />
    <meta
      property="og:url"
      content="/article/human-friendly-tokens/index.html"
    />

    <meta property="twitter:card" content="summary" />
    <meta name="twitter:site" content="compooter" />
    <meta name="twitter:title" content="Human friendly tokens" />
    <meta
      name="twitter:description"
      content="Thoughts on designing tokens for secrets, sessions, and tokens."
    />

    <link rel="stylesheet" href="/stylesheet/highlight-atom-one.css" />
    <style data-styled="true" data-styled-version="5.3.11">
      .rzRBI {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .rzRBI {
          color: #5eb6ff;
        }
      } /*!sc*/
      data-styled.g1[id='sc-aXZVg'] {
        content: 'rzRBI,';
      } /*!sc*/
      .juOMfq {
        padding-bottom: 4rem;
      } /*!sc*/
      data-styled.g2[id='sc-gEvEer'] {
        content: 'juOMfq,';
      } /*!sc*/
      .qTPpo {
        background-color: #fff;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .qTPpo {
          background-color: #16202e;
        }
      } /*!sc*/
      data-styled.g3[id='sc-eqUAAy'] {
        content: 'qTPpo,';
      } /*!sc*/
      .jTutFS {
        padding: 0px 1rem;
        max-width: 720px;
        margin: 0px auto;
      } /*!sc*/
      data-styled.g4[id='sc-fqkvVR'] {
        content: 'jTutFS,';
      } /*!sc*/
      .efqZme {
        margin: 15px 0em;
      } /*!sc*/
      .efqZme:first-child {
        margin-top: 0px;
      } /*!sc*/
      .efqZme:last-child {
        margin-bottom: 0px;
      } /*!sc*/
      data-styled.g5[id='sc-dcJsrY'] {
        content: 'efqZme,';
      } /*!sc*/
      .khRKiz {
        padding-top: 3rem;
        margin-bottom: 3rem;
      } /*!sc*/
      data-styled.g6[id='sc-iGgWBj'] {
        content: 'khRKiz,';
      } /*!sc*/
      .fmIvPa {
        font-size: 3rem;
        margin: 0px;
      } /*!sc*/
      @media (max-width: 720px) {
        .fmIvPa {
          font-size: 1.8rem;
        }
      } /*!sc*/
      data-styled.g7[id='sc-gsFSXq'] {
        content: 'fmIvPa,';
      } /*!sc*/
      .cFLcRl {
        margin: 0;
        line-height: 1.5rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .cFLcRl {
          color: #dbe0e7;
        }
      } /*!sc*/
      data-styled.g8[id='sc-kAyceB'] {
        content: 'cFLcRl,';
      } /*!sc*/
      .dpyEem {
        display: inline-block;
        font-size: 0.9rem;
        line-height: 1rem;
        background-color: #dcefff;
        color: #151515;
        border-radius: 3px;
        padding: 0.25rem 0.5rem;
        margin: 0.25rem 0.5rem 0.25rem 0;
        -webkit-text-decoration: none;
        text-decoration: none;
        white-space: nowrap;
      } /*!sc*/
      .dpyEem:hover {
        -webkit-text-decoration: underline;
        text-decoration: underline;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .dpyEem {
          background-color: #2f3d4e;
          color: #c8d2e0;
        }
      } /*!sc*/
      data-styled.g9[id='sc-imWYAI'] {
        content: 'dpyEem,';
      } /*!sc*/
      .ypGOR {
        color: inherit;
        -webkit-text-decoration: none;
        text-decoration: none;
      } /*!sc*/
      .ypGOR:hover span {
        -webkit-text-decoration: underline;
        text-decoration: underline;
      } /*!sc*/
      .ypGOR:hover:after {
        opacity: 1;
      } /*!sc*/
      .ypGOR:after {
        content: 'ðŸ”—';
        padding: 0 0.5rem;
        font-size: 1rem;
        opacity: 0.25;
      } /*!sc*/
      data-styled.g10[id='sc-jXbUNg'] {
        content: 'ypGOR,';
      } /*!sc*/
      .jXVzSo {
        padding: 1rem;
        margin: 3rem 0;
        background-color: #eef8ff;
        color: #4a8dc8;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .jXVzSo {
          background-color: #2a3d55;
          color: #95afd1;
        }
      } /*!sc*/
      .jXVzSo label {
        text-transform: uppercase;
        font-weight: bold;
        font-size: 0.85rem;
        color: #08273f;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .jXVzSo label {
          color: #dde0e3;
        }
      } /*!sc*/
      .jXVzSo .sc-kAyceB {
        color: #153248;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .jXVzSo .sc-kAyceB {
          color: #d0e4ff;
        }
      } /*!sc*/
      .jXVzSo ul {
        margin: 0.5rem 0;
        padding: 0;
        padding-left: 1rem;
      } /*!sc*/
      .jXVzSo a {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .jXVzSo a {
          color: #5eb6ff;
        }
      } /*!sc*/
      .jXVzSo a code {
        font-family: Monaco, monospace;
        font-size: 0.9rem;
        padding: 0 0.25rem;
        border-radius: 3px;
        background-color: #b9dbf5;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .jXVzSo a code {
          background-color: #354e6d;
        }
      } /*!sc*/
      data-styled.g11[id='sc-dhKdcB'] {
        content: 'jXVzSo,';
      } /*!sc*/
      * {
        box-sizing: border-box;
      } /*!sc*/
      body {
        margin: 0px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica,
          Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
          'Segoe UI Symbol';
        background-color: #eff7fd;
        color: #000;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #0d1117;
          color: #fff;
        }
      } /*!sc*/
      data-styled.g12[id='sc-global-kFwHxP1'] {
        content: 'sc-global-kFwHxP1,';
      } /*!sc*/
      .denQqw {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-pack: justify;
        -webkit-justify-content: space-between;
        -ms-flex-pack: justify;
        justify-content: space-between;
        -webkit-align-items: center;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
      } /*!sc*/
      .denQqw h1 {
        font-size: 1.5rem;
        padding: 1rem 0px;
        margin: 0;
      } /*!sc*/
      .denQqw h1 a {
        -webkit-text-decoration: none;
        text-decoration: none;
        color: inherit;
      } /*!sc*/
      .denQqw h1 a:hover {
        -webkit-text-decoration: underline;
        text-decoration: underline;
      } /*!sc*/
      @media (max-width: 720px) {
        .denQqw .sc-kpDqfm {
          display: none;
        }
      } /*!sc*/
      data-styled.g14[id='sc-dAlyuH'] {
        content: 'denQqw,';
      } /*!sc*/
      .frqlqR {
        border-top: 2px solid #d7d7d7;
        margin: 4rem 0;
        padding-top: 4rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .frqlqR {
          border-color: #4c545e;
        }
      } /*!sc*/
      data-styled.g54[id='sc-fXSgeo'] {
        content: 'frqlqR,';
      } /*!sc*/
      .eRjDjS h1 > a,
      .eRjDjS h2 > a,
      .eRjDjS h3 > a,
      .eRjDjS h4 > a,
      .eRjDjS h5 > a,
      .eRjDjS h6 > a {
        color: inherit;
        -webkit-text-decoration: none;
        text-decoration: none;
      } /*!sc*/
      .eRjDjS h1 > a:hover,
      .eRjDjS h2 > a:hover,
      .eRjDjS h3 > a:hover,
      .eRjDjS h4 > a:hover,
      .eRjDjS h5 > a:hover,
      .eRjDjS h6 > a:hover {
        -webkit-text-decoration: underline;
        text-decoration: underline;
      } /*!sc*/
      .eRjDjS p,
      .eRjDjS li {
        line-height: 1.5rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .eRjDjS p,
        .eRjDjS li {
          color: #dbe0e7;
        }
      } /*!sc*/
      .eRjDjS a {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .eRjDjS a {
          color: #5eb6ff;
        }
      } /*!sc*/
      .eRjDjS ul {
        padding-left: 1rem;
      } /*!sc*/
      .eRjDjS code {
        font-family: Monaco, monospace;
      } /*!sc*/
      .eRjDjS h1 code,
      .eRjDjS h2 code,
      .eRjDjS h3 code,
      .eRjDjS h4 code,
      .eRjDjS h5 code,
      .eRjDjS h6 code,
      .eRjDjS li code,
      .eRjDjS p code {
        font-size: 0.9em;
        padding: 0 0.25em;
        border-radius: 3px;
        background-color: #eff7fd;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .eRjDjS h1 code,
        .eRjDjS h2 code,
        .eRjDjS h3 code,
        .eRjDjS h4 code,
        .eRjDjS h5 code,
        .eRjDjS h6 code,
        .eRjDjS li code,
        .eRjDjS p code {
          background-color: #2b3644;
        }
      } /*!sc*/
      .eRjDjS pre {
        background-color: #eff7fd;
        padding: 0.5rem 0.75rem;
        overflow-x: scroll;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .eRjDjS pre {
          background-color: #2b3645;
        }
      } /*!sc*/
      .eRjDjS img {
        display: block;
        max-width: 100%;
        max-height: 520px;
        font-size: 0;
        margin: 0px auto;
        padding: 0px;
      } /*!sc*/
      .eRjDjS video {
        display: block;
        margin: 1rem auto;
      } /*!sc*/
      .eRjDjS figure {
        text-align: center;
        margin: 20px 0px;
      } /*!sc*/
      .eRjDjS figure img {
        display: block;
        max-width: 90vw;
        margin: 0px auto;
      } /*!sc*/
      .eRjDjS figure figcaption {
        opacity: 0.9;
        font-size: 1.1em;
        margin: 10px auto;
      } /*!sc*/
      .eRjDjS .cali-collage {
        padding: 20px 0px;
        text-align: center;
      } /*!sc*/
      .eRjDjS .cali-collage img {
        display: inline-block;
        margin: 10px;
        max-width: 95vw;
        vertical-align: middle;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
      } /*!sc*/
      data-styled.g55[id='sc-JrDLc'] {
        content: 'eRjDjS,';
      } /*!sc*/
      .jACQif {
        text-align: center;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .jACQif {
          color: #dbe0e7;
        }
      } /*!sc*/
      .jACQif h3 {
        margin: 0.5em 0;
      } /*!sc*/
      .jACQif p {
        margin: 0;
      } /*!sc*/
      data-styled.g56[id='sc-fjvvzt'] {
        content: 'jACQif,';
      } /*!sc*/
    </style>

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-G3SKTPFTEZ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag('js', new Date())
      gtag('config', 'G-G3SKTPFTEZ')
    </script>
  </head>
  <body>
    <div class="sc-eqUAAy qTPpo">
      <div class="sc-gEvEer juOMfq">
        <div class="sc-eqUAAy qTPpo">
          <div class="sc-fqkvVR jTutFS">
            <nav class="sc-dAlyuH denQqw">
              <h1><a href="/">Chris Andrejewski</a></h1>
            </nav>
          </div>
        </div>
        <div class="sc-fqkvVR jTutFS">
          <div class="sc-iGgWBj khRKiz">
            <p class="sc-kAyceB cFLcRl">
              <a href="/writing" class="sc-imWYAI dpyEem">Articles</a
              ><a
                href="/category/engineering/index.html"
                class="sc-imWYAI dpyEem"
                >Engineering</a
              >
            </p>
            <h1 class="sc-gsFSXq fmIvPa">
              <a href="#" class="sc-jXbUNg ypGOR"
                ><span>Human friendly tokens</span></a
              >
            </h1>
            <p class="sc-kAyceB cFLcRl">
              Thoughts on designing tokens for secrets, sessions, and tokens.
            </p>
          </div>
          <div class="sc-dhKdcB jXVzSo">
            <p class="sc-kAyceB cFLcRl"><label>Table of contents</label></p>
            <div>
              <ul>
                <li><a href="#make-copypaste-easy">Make copy/paste easy</a></li>
                <li><a href="#prefix-the-secret">Prefix the secret</a></li>
                <li>
                  <a href="#reasonably-ergonomic">Reasonably ergonomic</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="sc-dcJsrY efqZme">
            <div class="sc-JrDLc eRjDjS">
              <p>
                I've been working on an API which requires a bearer token (an
                API key) to authenticate and use. I've iterated on it a fair
                amount, so here are some considerations that went into their
                format.
              </p>
              <h1 id="make-copypaste-easy">
                <a href="#make-copypaste-easy">Make copy/paste easy</a>
              </h1>
              <p>Try to copy this secret:</p>
              <pre><code>bearer token: csjkncc csjndkc4-cdsnjk?34893cdnj
</code></pre>
              <p>Try to copy this secret:</p>
              <pre><code>bearer token: csjkncc_csjndkc4_cdsnjk_34893cdnj
</code></pre>
              <p>
                Text selection is an important characteristic of format. The
                ideal copying experience for a single token, is to be able to
                double-click and have the OS/browser/etc select the full text
                range for the user.
              </p>
              <p>
                To achieve this, we need to roughly follow the rules for what is
                generally considered a whole word in text selection: A-Z, a-z,
                and 0-9 characters (plus other accented, non-ASCII character but
                we don't tend to lean into those because we want to work in
                ASCII) and underscore (<code>_</code>).
              </p>
              <p>
                The quickest way to get there is taking whatever value you
                actually have as your secret, say in your database, and Base
                encoding it.
              </p>
              <p>
                Base64 is super common and well supported, but doesn't make the
                cut alphabet-wise. Base64 has <code>+</code> and
                <code>=</code> in its alphabet which as we can see does not play
                nicely with text selection:
              </p>
              <pre><code>bearer token: csjkncc=csjndkc4=cdsnjk=34893cdnj
bearer token: csjkncc+csjndkc4+cdsnjk+34893cdnj
</code></pre>
              <p>
                The web version Base64URL swaps <code>+</code>/<code>=</code>
                with <code>-</code>/<code>_</code> but dashes don't play nice
                either:
              </p>
              <pre><code>bearer token: csjkncc-csjndkc4-cdsnjk-34893cdnj
</code></pre>
              <p>
                We're so close! Luckily base encodings can be designed so we can
                use a Base <em>63</em> encoding to shave off the dash from the
                alphabet.
              </p>
              <p>
                The downside to defining a base encoding of your own is lack of
                ecosystem help (libraries providing encode/decode for free) and
                alignment with other developers as there is often not a standard
                on just what exactly the alphabet of characters will be.
              </p>
              <p>
                Base 63 would solve the text-selection problem, but I choose to
                go with Base 62 for my bearer tokens. I've seen Base62 and never
                seen Base63, but also I needed underscore (<code>_</code>)
                removed from the alphabet so I could use it for my own purpose:
              </p>
              <h1 id="prefix-the-secret">
                <a href="#prefix-the-secret">Prefix the secret</a>
              </h1>
              <p>
                Developers juggle a bunch of secrets and tokens in a reasonably
                complex system. Looking at walls and walls of nonsense text, a
                secret can self-identify itself by using a common prefix.
              </p>
              <p>For my bearer token I'm doing:</p>
              <pre><code>bt_{base_62_encoding_secret_value}
</code></pre>
              <p>
                The prefix makes it easy to know as a human that you are
                probably dealing with a bearer token, not a junk random string.
              </p>
              <h1 id="reasonably-ergonomic">
                <a href="#reasonably-ergonomic">Reasonably ergonomic</a>
              </h1>
              <p>
                I chose to go with Base62 for my bearer tokens. I was deciding
                between Base62 and Base58. Base58 is also common and the
                difference between the two is in their alphabet. Base58 removes
                characters which are visually similar to other characters:
                <code>0OIl</code> are not included.
              </p>
              <p>
                This is a great human consideration. For people reading these
                secrets, it's great that they can read them more reliably in
                different contexts.
              </p>
              <p>
                However, I don't want or need anyone reading these bearer
                tokens. I've made the copy-paste-able and obvious but I don't
                want to encourage or make it easy to read, speak, or type the
                individual characters in the secret. Copy it, paste it, and get
                on with life. My bearer tokens are long enough that someone will
                screw it up doing manual transcription anyways.
              </p>
              <p>
                Base58 has a place when you have situations where humans might
                need to be comparing these values, but with bearer tokens the
                only thing needing to look at the token is a computer.
              </p>
            </div>
          </div>
          <div class="sc-dcJsrY efqZme">
            <p class="sc-kAyceB cFLcRl">
              <small
                ><time
                  datetime="2022-09-11T00:00:00.000Z"
                  title="2022-09-11T00:00:00.000Z"
                  >Published 9/11/2022</time
                ></small
              >
            </p>
          </div>
          <div
            class="sc-fXSgeo frqlqR newsletter-container"
            data-frame-src="https://newsletter.jew.ski/frame/subscribe"
          >
            <div class="sc-fjvvzt jACQif">
              <h3>Subscribe for new articles</h3>
              <div class="newsletter-form"></div>
              <p>
                <small
                  >Or add the
                  <a href="/writing/feed.atom.xml" class="sc-aXZVg rzRBI"
                    >Atom feed</a
                  >
                  to your feed reader.</small
                >
              </p>
            </div>
            <script src="https://newsletter-js.jew.ski/v1/subscribe-embed.js"></script>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>

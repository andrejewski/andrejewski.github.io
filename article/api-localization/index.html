<!doctype html>
<html lang="en-US">
  <head>
    <title>API localization</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="description" content="Advice on localizing an API experience" />
    <meta name="robots" content="index, follow" />

    <link
      rel="canonical"
      href="https://jew.ski/article/api-localization/index.html"
    />

    <link rel="icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" href="/logo192.png" />

    <meta name="theme-color" content="#178bfb" />

    <meta property="og:title" content="API localization" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="Chris Andrejewski" />
    <meta property="og:url" content="/article/api-localization/index.html" />

    <meta property="twitter:card" content="summary" />
    <meta name="twitter:site" content="compooter" />
    <meta name="twitter:title" content="API localization" />
    <meta
      name="twitter:description"
      content="Advice on localizing an API experience"
    />

    <link rel="stylesheet" href="/stylesheet/highlight-atom-one.css" />
    <style data-styled="true" data-styled-version="6.1.17">
      .bctNTf {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bctNTf {
          color: #5eb6ff;
        }
      } /*!sc*/
      data-styled.g1[id='sc-Qotzb'] {
        content: 'bctNTf,';
      } /*!sc*/
      .hxbvAH {
        padding-bottom: 4rem;
      } /*!sc*/
      data-styled.g2[id='sc-fYsHOw'] {
        content: 'hxbvAH,';
      } /*!sc*/
      .debzsy {
        background-color: #fff;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .debzsy {
          background-color: #16202e;
        }
      } /*!sc*/
      data-styled.g3[id='sc-dKREkF'] {
        content: 'debzsy,';
      } /*!sc*/
      .dtgyPg {
        padding: 0px 1rem;
        max-width: 720px;
        margin: 0px auto;
      } /*!sc*/
      data-styled.g4[id='sc-fWnslK'] {
        content: 'dtgyPg,';
      } /*!sc*/
      .eyyqef {
        margin: 15px 0em;
      } /*!sc*/
      .eyyqef:first-child {
        margin-top: 0px;
      } /*!sc*/
      .eyyqef:last-child {
        margin-bottom: 0px;
      } /*!sc*/
      data-styled.g5[id='sc-dIMoHT'] {
        content: 'eyyqef,';
      } /*!sc*/
      .hkwuxz {
        padding-top: 3rem;
        margin-bottom: 3rem;
      } /*!sc*/
      data-styled.g6[id='sc-iQQCXo'] {
        content: 'hkwuxz,';
      } /*!sc*/
      .foDfFI {
        font-size: 3rem;
        margin: 0px;
      } /*!sc*/
      @media (max-width: 720px) {
        .foDfFI {
          font-size: 1.8rem;
        }
      } /*!sc*/
      data-styled.g7[id='sc-gDpztx'] {
        content: 'foDfFI,';
      } /*!sc*/
      .iwpgrf {
        margin: 0;
        line-height: 1.5rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .iwpgrf {
          color: #dbe0e7;
        }
      } /*!sc*/
      data-styled.g8[id='sc-kpOvIu'] {
        content: 'iwpgrf,';
      } /*!sc*/
      .leFObR {
        display: inline-block;
        font-size: 0.9rem;
        line-height: 1rem;
        background-color: #dcefff;
        color: #151515;
        border-radius: 3px;
        padding: 0.25rem 0.5rem;
        margin: 0.25rem 0.5rem 0.25rem 0;
        text-decoration: none;
        white-space: nowrap;
      } /*!sc*/
      .leFObR:hover {
        text-decoration: underline;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .leFObR {
          background-color: #2f3d4e;
          color: #c8d2e0;
        }
      } /*!sc*/
      data-styled.g9[id='sc-icnseD'] {
        content: 'leFObR,';
      } /*!sc*/
      .iLjxYJ {
        color: inherit;
        text-decoration: none;
      } /*!sc*/
      .iLjxYJ:hover span {
        text-decoration: underline;
      } /*!sc*/
      .iLjxYJ:hover:after {
        opacity: 1;
      } /*!sc*/
      .iLjxYJ:after {
        content: 'ðŸ”—';
        padding: 0 0.5rem;
        font-size: 1rem;
        opacity: 0.25;
      } /*!sc*/
      data-styled.g10[id='sc-jMsorb'] {
        content: 'iLjxYJ,';
      } /*!sc*/
      .hskrPk {
        padding: 1rem;
        margin: 3rem 0;
        background-color: #eef8ff;
        color: #4a8dc8;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .hskrPk {
          background-color: #2a3d55;
          color: #95afd1;
        }
      } /*!sc*/
      .hskrPk label {
        text-transform: uppercase;
        font-weight: bold;
        font-size: 0.85rem;
        color: #08273f;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .hskrPk label {
          color: #dde0e3;
        }
      } /*!sc*/
      .hskrPk .sc-kpOvIu {
        color: #153248;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .hskrPk .sc-kpOvIu {
          color: #d0e4ff;
        }
      } /*!sc*/
      .hskrPk ul {
        margin: 0.5rem 0;
        padding: 0;
        padding-left: 1rem;
      } /*!sc*/
      .hskrPk a {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .hskrPk a {
          color: #5eb6ff;
        }
      } /*!sc*/
      .hskrPk a code {
        font-family: Monaco, monospace;
        font-size: 0.9rem;
        padding: 0 0.25rem;
        border-radius: 3px;
        background-color: #b9dbf5;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .hskrPk a code {
          background-color: #354e6d;
        }
      } /*!sc*/
      data-styled.g11[id='sc-cXawGu'] {
        content: 'hskrPk,';
      } /*!sc*/
      * {
        box-sizing: border-box;
      } /*!sc*/
      body {
        margin: 0px;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica,
          Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji',
          'Segoe UI Symbol';
        background-color: #eff7fd;
        color: #000;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #0d1117;
          color: #fff;
        }
      } /*!sc*/
      data-styled.g12[id='sc-global-kFwHxP1'] {
        content: 'sc-global-kFwHxP1,';
      } /*!sc*/
      .jjMGJZ {
        display: flex;
        justify-content: space-between;
        align-items: center;
      } /*!sc*/
      .jjMGJZ h1 {
        font-size: 1.5rem;
        padding: 1rem 0px;
        margin: 0;
      } /*!sc*/
      .jjMGJZ h1 a {
        text-decoration: none;
        color: inherit;
      } /*!sc*/
      .jjMGJZ h1 a:hover {
        text-decoration: underline;
      } /*!sc*/
      @media (max-width: 720px) {
        .jjMGJZ .sc-jJAtPt {
          display: none;
        }
      } /*!sc*/
      data-styled.g14[id='sc-cUiCeM'] {
        content: 'jjMGJZ,';
      } /*!sc*/
      .eEeLHI {
        border-top: 2px solid #d7d7d7;
        margin: 4rem 0;
        padding-top: 4rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .eEeLHI {
          border-color: #4c545e;
        }
      } /*!sc*/
      data-styled.g43[id='sc-kiMgGE'] {
        content: 'eEeLHI,';
      } /*!sc*/
      .bBqidV h1 > a,
      .bBqidV h2 > a,
      .bBqidV h3 > a,
      .bBqidV h4 > a,
      .bBqidV h5 > a,
      .bBqidV h6 > a {
        color: inherit;
        text-decoration: none;
      } /*!sc*/
      .bBqidV h1 > a:hover,
      .bBqidV h2 > a:hover,
      .bBqidV h3 > a:hover,
      .bBqidV h4 > a:hover,
      .bBqidV h5 > a:hover,
      .bBqidV h6 > a:hover {
        text-decoration: underline;
      } /*!sc*/
      .bBqidV p,
      .bBqidV li {
        line-height: 1.5rem;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV p,
        .bBqidV li {
          color: #dbe0e7;
        }
      } /*!sc*/
      .bBqidV a {
        color: rgb(6, 90, 163);
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV a {
          color: #5eb6ff;
        }
      } /*!sc*/
      .bBqidV ul {
        padding-left: 1rem;
      } /*!sc*/
      .bBqidV code {
        font-family: Monaco, monospace;
      } /*!sc*/
      .bBqidV h1 code,
      .bBqidV h2 code,
      .bBqidV h3 code,
      .bBqidV h4 code,
      .bBqidV h5 code,
      .bBqidV h6 code,
      .bBqidV li code,
      .bBqidV p code {
        font-size: 0.9em;
        padding: 0 0.25em;
        border-radius: 3px;
        background-color: #eff7fd;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV h1 code,
        .bBqidV h2 code,
        .bBqidV h3 code,
        .bBqidV h4 code,
        .bBqidV h5 code,
        .bBqidV h6 code,
        .bBqidV li code,
        .bBqidV p code {
          background-color: #2b3644;
        }
      } /*!sc*/
      .bBqidV pre {
        background-color: #eff7fd;
        padding: 0.5rem 0.75rem;
        overflow-x: scroll;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .bBqidV pre {
          background-color: #2b3645;
        }
      } /*!sc*/
      .bBqidV img {
        display: block;
        max-width: 100%;
        max-height: 520px;
        font-size: 0;
        margin: 0px auto;
        padding: 0px;
      } /*!sc*/
      .bBqidV video {
        display: block;
        margin: 1rem auto;
      } /*!sc*/
      .bBqidV figure {
        text-align: center;
        margin: 20px 0px;
      } /*!sc*/
      .bBqidV figure img {
        display: block;
        max-width: 90vw;
        margin: 0px auto;
      } /*!sc*/
      .bBqidV figure figcaption {
        opacity: 0.9;
        font-size: 1.1em;
        margin: 10px auto;
      } /*!sc*/
      .bBqidV .cali-collage {
        padding: 20px 0px;
        text-align: center;
      } /*!sc*/
      .bBqidV .cali-collage img {
        display: inline-block;
        margin: 10px;
        max-width: 95vw;
        vertical-align: middle;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
      } /*!sc*/
      data-styled.g44[id='sc-dCVDEO'] {
        content: 'bBqidV,';
      } /*!sc*/
      .hwSrQD {
        text-align: center;
      } /*!sc*/
      @media (prefers-color-scheme: dark) {
        .hwSrQD {
          color: #dbe0e7;
        }
      } /*!sc*/
      .hwSrQD h3 {
        margin: 0.5em 0;
      } /*!sc*/
      .hwSrQD p {
        margin: 0;
      } /*!sc*/
      data-styled.g45[id='sc-fhPBcz'] {
        content: 'hwSrQD,';
      } /*!sc*/
    </style>

    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-G3SKTPFTEZ"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []
      function gtag() {
        dataLayer.push(arguments)
      }
      gtag('js', new Date())
      gtag('config', 'G-G3SKTPFTEZ')
    </script>
  </head>
  <body>
    <div class="sc-dKREkF debzsy">
      <div class="sc-fYsHOw hxbvAH">
        <div class="sc-dKREkF debzsy">
          <div class="sc-fWnslK dtgyPg">
            <nav class="sc-cUiCeM jjMGJZ">
              <h1><a href="/">Chris Andrejewski</a></h1>
            </nav>
          </div>
        </div>
        <div class="sc-fWnslK dtgyPg">
          <div class="sc-iQQCXo hkwuxz">
            <p class="sc-kpOvIu iwpgrf">
              <a href="/writing" class="sc-icnseD leFObR">Articles</a
              ><a
                href="/category/engineering/index.html"
                class="sc-icnseD leFObR"
                >Engineering</a
              >
            </p>
            <h1 class="sc-gDpztx foDfFI">
              <a href="#" class="sc-jMsorb iLjxYJ"
                ><span>API localization</span></a
              >
            </h1>
            <p class="sc-kpOvIu iwpgrf">
              Advice on localizing an API experience
            </p>
          </div>
          <div class="sc-cXawGu hskrPk">
            <p class="sc-kpOvIu iwpgrf"><label>Table of contents</label></p>
            <div>
              <ul>
                <li>
                  <a href="#error-messages-user-vs-developer"
                    >Error messages: user vs developer</a
                  >
                </li>
                <li><a href="#data-is-the-bedrock">Data is the bedrock</a></li>
                <li>
                  <a href="#developer-localization">Developer localization</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="sc-dIMoHT eyyqef">
            <div class="sc-dCVDEO bBqidV">
              <p>
                You may have been tasked with localizing an API. This is often
                the case with APIs more near to end-customers or users.
                Offloading the responsibility for localization to an API
                provider in some ways can be seen as optimal. Why have N
                integrations repeat the translation of simpler touch-points to
                an API? Alas, the only absolute truth of software localization
                is that we underestimate the complexity of doing it well
                absolutely.
              </p>
              <p>
                That difficulty is a challenge, not a dismissal, of the pursuit
                of localizing an API. Even if it is not perfect in
                implementation, localization can be a huge value add.
              </p>
              <p>
                As the &quot;Internationalization guy&quot; at Stripe, I've been
                asked on numerous occasions about whether and how Stripe should
                localize its API. These are my thoughts on the broader space of
                localizing any API which will get you the most bang for your
                localization buck.
              </p>
              <h2 id="error-messages:-user-vs-developer">
                <a href="#error-messages:-user-vs-developer"
                  >Error messages: user vs developer</a
                >
              </h2>
              <p>
                The first thing one might consider localizing is the API error
                messages. They are the most textual and fit into existing string
                translation pipelines with only a bit of work. One of those
                pipelines looks like these steps:
              </p>
              <ul>
                <li>Tag each message with an ID,</li>
                <li>
                  Upload source message files to translators (in data,
                  <code
                    >HashMap&lt;MessageID: string, ErrorMessage:
                    string&gt;</code
                  >)
                </li>
                <li>
                  Download completed translations to be used in the application.
                </li>
                <li>
                  For a locale, if the translated message is available for the
                  ID, use it.
                </li>
              </ul>
              <p>
                Something you'll want to hammer out and quickly is the intended
                audience of the error messages. Are they for developers to aid
                them in debugging integration issues, or are they intended to be
                surfaced directly to users, perhaps in a user interface?
              </p>
              <p>
                I recommend separating the considerations for the two audiences.
                The API error messages should be developer facing exclusively.
                If the API errors are intended to be resurfaced to users, I
                would suggest a more <strong>human-oriented API</strong>.
              </p>
              <p>
                A more human API looks like (1) for validation errors returning
                all of the validation errors in a batch as opposed to returning
                early on any single validation like a computer would be okay
                with. It also means (2) understanding the user interface as most
                likely some kind of form and allowing certain errors to be
                attributable easily back to certain form fields. Lastly, (3)
                humans provide data sparingly and out of order so have API
                resources which model partial submissions or drafted objects.
                These considerations make for a larger, different API.
              </p>
              <p>
                That's a lot of work and not applicable to some integrators' use
                cases anyways. Human oriented APIs I think work best when
                offered as a layered approach atop the low-level.
              </p>
              <h2 id="data-is-the-bedrock">
                <a href="#data-is-the-bedrock">Data is the bedrock</a>
              </h2>
              <p>
                A common scenario API integrators find themselves in: the error
                is generic and the error message is more specific. If the
                integrator cares to model that more specific information they
                must resort to string parsing on the error message.
              </p>
              <p>An example would be:</p>
              <pre><code class="language-js"><span class="hljs-comment">// US</span>
{
  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;error&#x27;</span>,
  <span class="hljs-attr">kind</span>: <span class="hljs-string">&#x27;tax_id_invalid&#x27;</span>,
  <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Taxpayer identification numbers (TIN) is required&quot;</span>
}
<span class="hljs-comment">// Canada</span>
{
  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;error&#x27;</span>,
  <span class="hljs-attr">kind</span>: <span class="hljs-string">&#x27;tax_id_invalid&#x27;</span>,
  <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Individual Tax Number (ITN) is required&quot;</span>
}
</code></pre>
              <p>
                We've embedded context only available in the error message so
                the integrator must either do string parsing or present this
                error to the user to provide a decent user experience.
              </p>
              <p>
                This isn't a localization only concern but is something that a
                lot of providers of APIs force on their users inadvertently by
                providing great error messages without
                <strong>great error data</strong>.
              </p>
              <p>
                Localization is no different than other cases. If you're going
                to offer more context in the error message, you'll also want to
                offer the same information as machine readable data.
              </p>
              <p>In the above example, we'd want to offer data to match:</p>
              <pre><code class="language-js"><span class="hljs-comment">// US</span>
{
  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;error&#x27;</span>,
  <span class="hljs-attr">kind</span>: <span class="hljs-string">&#x27;tax_id_invalid&#x27;</span>,
  <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Taxpayer identification numbers (TIN) is required&quot;</span>,
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">type_id_type</span>: <span class="hljs-string">&#x27;us_tin&#x27;</span>
  }
}
<span class="hljs-comment">// Canada</span>
{
  <span class="hljs-attr">type</span>: <span class="hljs-string">&#x27;error&#x27;</span>,
  <span class="hljs-attr">kind</span>: <span class="hljs-string">&#x27;tax_id_invalid&#x27;</span>,
  <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Individual Tax Number (ITN) is required&quot;</span>,
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">type_id_type</span>: <span class="hljs-string">&#x27;ca_itn&#x27;</span>
  }
}
</code></pre>
              <p>
                We don't need to give the pretty, human readable names as data
                fields. We only need to convey the information in a
                distinguishable way.
              </p>
              <p>
                For localization, this error data becomes essential to allowing
                integrators to localize their interfaces either with proper tone
                of voice for their businesses and target markets (some markets
                like a calm voice, some like a strictly professional voice) and
                expand beyond the supported set of locales that your API offers.
              </p>
              <h2 id="developer-localization">
                <a href="#developer-localization">Developer localization</a>
              </h2>
              <p>
                It is easy to get really excited about localizing APIs. After
                all, programming is so overwhelmingly English-centric it's hard
                not to have sympathy for everyone else.
              </p>
              <p>
                However we need to balance our pure vision with the realities of
                programming. The vast majority of API integrators, upon hitting
                an error or unexpected state, ask a computer. Search engines,
                help forums, and LLMs work best on a common text or source
                language. If we provide a localized error and they can't get to
                the reference material and external information about the error
                with ease, that's also a bad development experience.
              </p>
              <p>
                Having extensive error catalogs are great and more APIs should
                have them alongside their API reference documentation, but these
                resources often can't tell the whole story of how to handle
                these cases. We need richer examples, peer discussion, and
                lessons already learned the hard way.
              </p>
              <p>
                Giving access to the canonical / source error message is
                essential. Make it easy to get it! Some ways you might do so:
              </p>
              <ul>
                <li>
                  Include <code>message</code> and
                  <code>localized_message</code> together always. This is
                  simplest, allowing the developer to use both without any
                  configuration flipping. The edges are:
                  <ul>
                    <li>
                      How to handle the source locale? Do we include the exact
                      error message twice or do we only show
                      <code>localized_message</code> when the two errors differ?
                      Probably the latter.
                    </li>
                    <li>
                      Be prepared for scrutiny of your translation quality.
                      Side-by-side translation presented in this way is going to
                      help you stomp out quality issues quickly if you embrace
                      the feedback on how to improve them instead of being
                      demoralized by it.
                    </li>
                  </ul>
                </li>
                <li>
                  Make developer locale something easily configured per request
                  using HTTP headers, environment variables, or other easy-add
                  inputs to your API.
                  <ul>
                    <li>
                      Not allowing per-request configuration and instead
                      requiring locale be set at some account, user, or API key
                      level is frictional. Our goal in catering to the developer
                      via localization is that getting their job done well is
                      easier. Our goal is to not localize for the sake of it.
                    </li>
                  </ul>
                </li>
              </ul>
              <p>
                Developer localization is an area which still after so long is
                ripe for experimentation on the right way to do it. Good luck!
              </p>
            </div>
          </div>
          <div class="sc-dIMoHT eyyqef">
            <p class="sc-kpOvIu iwpgrf">
              <small
                ><time
                  datetime="2024-07-04T00:00:00.000Z"
                  title="2024-07-04T00:00:00.000Z"
                  >Published 7/4/2024</time
                ></small
              >
            </p>
          </div>
          <div
            class="sc-kiMgGE eEeLHI newsletter-container"
            data-frame-src="https://newsletter.jew.ski/frame/subscribe"
          >
            <div class="sc-fhPBcz hwSrQD">
              <h3>Subscribe for new articles</h3>
              <div class="newsletter-form"></div>
              <p>
                <small
                  >Or add the
                  <a href="/writing/feed.atom.xml" class="sc-Qotzb bctNTf"
                    >Atom feed</a
                  >
                  to your feed reader.</small
                >
              </p>
            </div>
            <script src="https://newsletter-js.jew.ski/v1/subscribe-embed.js"></script>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
